---
title: "Report"
author: "Arbias Kadriu"
date: "2023-03-09"
output: html_document
---

# AGDS Report

## Cleaning dat afrom elecated CO2 experiments

### Task 1 
## first the document for this task will be brought to the RStudio and it will be controlled if the transfer worked.
```{r}
list.files("/Users/arbi7/Documents/agds_report_arbiaskadriu")
databaseS1 <- readr::read_csv("/Users/arbi7/Documents/agds_report_arbiaskadriu/AGDS_Exercise_1.csv")

show(databaseS1)

```

### Task 2
# The transfered data, which is called previously databaseS1 will be transformed, will be renamed to sample_date_RR and a new columns will be added. This new row represents the log_response_ratio, which gives back the logarithm of increased CO2 divided by ambient CO2
```{r}
sample_date_RR <- dplyr::mutate(databaseS1, log_response_ratio = log(databaseS1$`increased CO2`/databaseS1$`ambient CO2`))

show(sample_date_RR)

```

# Now 
```{r}

sample_date_yearly <- sample_date_RR |>
  dplyr::group_by(sample_date_RR$`Experiment`, sample_date_RR$`Sample date`) |>
  dplyr::summarise(log_response_ratio_mean = mean(log_response_ratio))

colnames(sample_date_yearly)[1] <- "Experiment"
colnames(sample_date_yearly)[2] <- "sample date"
colnames(sample_date_yearly)[3] <- "Log response ratio, mean"

show(sample_date_yearly)

```

```{r}
knitr::kable(sample_date_yearly)
```

### Task 3
```{r}
early_phase <- dplyr::filter(sample_date_RR, sample_date_RR$`Time (years)` <3) |>
  dplyr::summarise(log_response_ratio_mean = mean(log_response_ratio))

```

```{r}
mid_phase <- dplyr::filter(sample_date_RR, sample_date_RR$`Time (years)` >=3 & sample_date_RR$`Time (years)`<6) |>
  dplyr::summarise(log_response_ratio_mean = mean(log_response_ratio))

```

```{r}
late_phase <- dplyr::filter(sample_date_RR, sample_date_RR$`Time (years)` >=6) |>
  dplyr::summarise(log_response_ratio_mean = mean(log_response_ratio))

```

```{r}
all_phases <- rbind(early_phase, mid_phase, late_phase)
all_phases <- dplyr::mutate(all_phases, "Phases" = c("early Phase (under 3 years since start)", "mid phase (between 3 and 6 years since start)", "late phase (over 6 years since start)"))
all_phases <- dplyr::select(all_phases, "Phases", "log_response_ratio_mean")

```

```{r}
knitr::kable(all_phases)
```
















## Telling a story from data


```{r}
# Load the airquality dataset
data(airquality)
airdata <- datasets::airquality

airdata <- cbind(seq(nrow(airdata)), airdata)

# Rename the row number column
names(airdata)[1] <- "Days"
names(airdata)[5] <- "Temperature (F)"

# Clean the data by removing any rows with missing values
airdata <- na.omit(airdata)



library(ggplot2)
ggplot(airdata, aes(x = Days, y = `Temperature (F)`)) + geom_line() + ggtitle("Temperature in New York over Mai to September")

```


```{r}
# Figure 2: Plot and connection of temperature and ozone with a boxplot of ozone

data(airquality)

ggplot(airquality, aes(x = Temp, y = Ozone)) +
  geom_point(alpha = 0.5) +
  ggtitle("Scatterplot of Temperature and Ozone")

ggplot(airquality, aes(y = Ozone)) +
  geom_boxplot() +
  ggtitle("Boxplot of Ozone")

# The plot shows a correlation between temperature and ozone, but which is very weak. It can be seen that at higher temperature there is also a higher ozone, this can come from that the ozone reflex the sunlight. More sunlight resumes to higher temperature on New York. The boxplot shows how reliable the data is and how many outliers are in those data. It can be seen that there are not many outliers, which indicates that the data is reliable. These high values could be an indicate that New York as unusually high levels of pollution on those certain days. Polution can also affect the ozone aswell the temperature.

```




```{r}
# Figure 3: The plot shows that the ozone tends to be at highest on the later months around July, August and September.
data(airquality)

ggplot(airquality, aes(x = Day, y = Ozone, group = Month, color = Month)) +
  geom_line() +
  ggtitle("Temporal Pattern of Ozone Levels") +
  xlab("Day") +
  ylab("Ozone Concentration")


```


